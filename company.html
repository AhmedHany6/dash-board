<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Company Management</title>
 <!-- fontAwesome -->
    <link rel="stylesheet" href="css/vendor/all.min.css"> 
    
    <link rel="stylesheet" href="./css/pages/company.css">

    <link rel="stylesheet" href="css/style.css" />
    <style>
      .confirmation-dialog {
        background-color: white;
        border-radius: 10px;
        padding: 25px;
        width: 350px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        text-align: center;
      }
      .confirmation-title {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 15px;
        color: #333;
      }
      .confirmation-message {
        font-size: 16px;
        color: #666;
        margin-bottom: 25px;
      }
    </style>
  </head>





  <body>
    <div class="header">
      <!-- ‚úÖ Navbar -->
      <nav class="top-bar">
        <div class="search-container">
          <input type="text" placeholder="Search..." class="search-input" />
          <button class="search-button">
            <i class="fa-sharp fa-solid fa-magnifying-glass"></i>
          </button>
        </div>
        <div class="icon-section">
          <i class="fas fa-envelope"></i>
          <!-- ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ŸÖÿπ ÿßŸÑÿ®ÿßÿØÿ¨ -->
          <div class="notification-container">
            <i class="fas fa-bell" id="notificationBell"
              ><span class="notification-badge">4</span></i
            >

            <!-- Dropdown ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ -->
            <div class="notification-dropdown" id="notificationDropdown">
              <div class="dropdown-header">
                <h3>Notifications</h3>
                <a href="#" class="mark-read">Mark all as read</a>
              </div>

              <div class="notification-list">
                <!-- ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ© -->
                <div class="notification-section">
                  <h4>NEW</h4>
                  <div class="notification-item unread">
                    <div class="notification-content">
                      Emma Watson replied to your comment: "Hello world üòä"
                      <span class="notification-time">Just now</span>
                    </div>
                  </div>
                  <!-- ÿ®ÿßŸÇŸä ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ŸáŸÜÿß -->
                </div>

                <!-- ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÇÿØŸäŸÖÿ© -->
                <div class="notification-section">
                  <h4>EARLIER</h4>
                  <div class="notification-item">
                    <div class="notification-content">
                      The forecast today shows a low of 20¬∞C in California.
                      <span class="notification-time">8h ago</span>
                    </div>
                  </div>
                  <!-- ÿ®ÿßŸÇŸä ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ŸáŸÜÿß -->
                </div>
              </div>

              <a href="nofigation.html" class="view-all">View all</a>
            </div>
          </div>
          <i class="fas fa-layer-group"></i>
          <div class="user-profile" onclick="toggleDropdown()">
            <img src="assets/images/avata.jpeg" alt="image profile" />
            <span>Hi, Hizrian</span>

            <div class="dropdown-box">
              <div class="user-info">
                <h3>Kevin Anderson</h3>
                <p>ŸÖÿµŸÖŸÖ ŸÖŸàÿßŸÇÿπ</p>
              </div>
              <ul>
                <li><i class="fas fa-user"></i> ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ¥ÿÆÿµŸä</li>
                <li><i class="fas fa-cog"></i> ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</li>
                <li><i class="fas fa-question-circle"></i> ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©</li>
                <li><i class="fas fa-sign-out-alt"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨</li>
              </ul>
            </div>
          </div>
        </div>
      </nav>
    </div>

    <!-- =============== sidebar ================ -->

    <div class="sidebar">
      <div class="sidebar-header">
        <img src="assets/images/logo.png" alt="logo" />
        <div class="toggle-btn">‚ò∞</div>
      </div>

      <ul>
        <li data-id="dashboard">
          <a href="index.html">
            <span class="icon">
              <i class="fa-sharp fa-solid fa-house"></i>
            </span>
            <span class="text">Dashboard</span>
          </a>
        </li>

        <li data-id="users">
          <a href="user.html">
            <span class="icon">
              <i class="fa-solid fa-users"></i>
            </span>
            <span class="text">Users</span>
          </a>
        </li>

        <li data-id="jobs">
          <a href="job.html">
            <span class="icon">
              <i class="fa-solid fa-briefcase"></i>
            </span>
            <span class="text">Jobs</span>
          </a>
        </li>

        <li data-id="view">
          <a href="view.html">
            <span class="icon">
              <i class="fa-sharp fa-solid fa-eye"></i>
            </span>
            <span class="text">View jobs</span>
          </a>
        </li>

        <li data-id="companies">
          <a href="company.html">
            <span class="icon">
              <i class="fa-solid fa-buildings"></i>
            </span>
            <span class="text">Companies</span>
          </a>
        </li>
        <li>
          <a href="./app/chat.html">
            <span class="icon">
              <i class="fas fa-comments"></i>
            </span>
            <span class="text">Chat</span>
          </a>
        </li>

        <li data-id="profile">
          <a href="about.html">
            <span class="icon">
              <i class="fa-solid fa-user"></i>
            </span>
            <span class="text">Profile</span>
          </a>
        </li>

        <li data-id="register">
          <a href="./signup.html">
            <span class="icon">
              <i class="fa-solid fa-user-plus"></i>
            </span>
            <span class="text">Register</span>
          </a>
        </li>

        <li data-id="setting">
          <a href="setting.html">
            <span class="icon">
              <i class="fa-solid fa-gear"></i>
            </span>
            <span class="text">Settings</span>
          </a>
        </li>

        <li data-id="logout">
          <a href="register.html">
            <span class="icon">
              <i class="fa-solid fa-right-from-bracket"></i>
            </span>
            <span class="text">Logout</span>
          </a>
        </li>
      </ul>
    </div>

    <!-- ‚úÖ Main Container -->
    <section class="main-panel">
      <div class="container-fluid">
        <h2 class="my-5">Company List</h2>
        <!-- ‚úÖ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ™ÿµŸÖŸäŸÖ ÿßŸÑŸÅŸÑÿ™ÿ±ÿ© -->
        <div class="filter-section">
          <label for="statusFilter">Status:</label>
          <select id="statusFilter">
            <option value="">All</option>
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
          </select>

          <label for="jobsFilter">Job Count:</label>
          <input type="number" id="jobsFilter" min="0" placeholder="Min Jobs" />

          <button onclick="filterCompanies()">Filter</button>
        </div>

        <!-- ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸàŸÑ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ -->
        <div class="table-container my-5">
          <table>
            <thead>
              <tr>
                <th>Company Name</th>
                <th>size</th>
                <th>Job Count</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="companyTableBody">
              <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿØŸäŸÜÿßŸÖŸäŸÉŸäŸãÿß -->
            </tbody>
          </table>
        </div>

        <!-- ‚úÖ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ŸÅŸä ÿßŸÑŸÖŸàÿ®ÿßŸäŸÑ -->
        <div id="companyList" class="company-list"></div>
      </div>
    </section>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const bellIcon = document.getElementById("notificationBell");
        const dropdown = document.getElementById("notificationDropdown");
        const viewAllLink = document.querySelector(".view-all");

        // ÿ•ÿ∏Ÿáÿßÿ± / ÿ•ÿÆŸÅÿßÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑÿ¨ÿ±ÿ≥
        bellIcon.addEventListener("click", function (e) {
          e.stopPropagation();
          dropdown.style.display =
            dropdown.style.display === "block" ? "none" : "block";
        });

        // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿ•ÿ∞ÿß ÿ™ŸÖ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
        document.addEventListener("click", function (e) {
          if (!e.target.closest(".notification-container")) {
            dropdown.style.display = "none";
          }
        });

        // ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ "View all" Ÿäÿ™ŸÖ ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ŸÑŸÑÿµŸÅÿ≠ÿ©
        viewAllLink.addEventListener("click", function (e) {
          e.preventDefault();
          window.location.href = this.getAttribute("href");
        });
      });
    </script>

    <!-- js -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/company.js"></script>
    <script src="./js/main.js" defer></script>
   <script>
// company-management.js
document.addEventListener('DOMContentLoaded', function() {
    loadCompanyData();
});

async function loadCompanyData() {
    try {
        const apiResponse = await fetch('https://jobizaa.com/api/admin/companies');
        if (!apiResponse.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const companyData = await apiResponse.json();
        renderCompanyTable(companyData);
    } catch (error) {
        console.error('Data loading error:', error);
        Swal.fire({
            icon: 'error',
            title: 'Loading Error',
            text: 'Failed to load company data: ' + error.message,
            confirmButtonText: 'OK'
        });
    }
}

function renderCompanyTable(companies) {
    const companyTable = document.getElementById('companyDataTable');
    const mobileCompanyView = document.getElementById('mobileCompanyList');
    
    // Clear existing data
    companyTable.innerHTML = '';
    mobileCompanyView.innerHTML = '';
    
    // Populate table view
    companies.forEach(company => {
        const tableRow = document.createElement('tr');
        tableRow.innerHTML = `
            <td class="company-name">${company.name}</td>
            <td class="company-size">${company.size}</td>
            <td class="job-count">${company.job_count || 0}</td>
            <td class="status-cell"><span class="company-status active">Active</span></td>
            <td class="action-buttons">
                <button class="edit-btn btn-primary">Edit</button>
                <button class="delete-btn btn-danger" onclick="removeCompany(${company.id})">Delete</button>
            </td>
        `;
        companyTable.appendChild(tableRow);
        
        // Populate mobile view
        const mobileItem = document.createElement('div');
        mobileItem.className = 'company-card';
        mobileItem.innerHTML = `
            <div class="company-details">
                <h3 class="company-title">${company.name}</h3>
                <p class="company-meta"><span class="meta-label">Size:</span> ${company.size}</p>
                <p class="company-meta"><span class="meta-label">Jobs:</span> ${company.job_count || 0}</p>
                <p class="company-meta"><span class="meta-label">Status:</span> <span class="status-badge active">Active</span></p>
            </div>
            <div class="action-buttons">
                <button class="edit-btn btn-primary">Edit</button>
                <button class="delete-btn btn-danger" onclick="removeCompany(${company.id})">Delete</button>
            </div>
        `;
        mobileCompanyView.appendChild(mobileItem);
    });
}

async function removeCompany(companyId) {
    try {
        const confirmation = await Swal.fire({
            title: 'Confirm Deletion',
            text: "This action cannot be undone!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Delete',
            cancelButtonText: 'Cancel'
        });
        
        if (confirmation.isConfirmed) {
            const deleteResponse = await fetch(`https://jobizaa.com/api/admin/companies/${companyId}`, {
                method: 'DELETE',
                headers: {
                    // 'Authorization': 'Bearer YOUR_ACCESS_TOKEN'
                }
            });
            
            if (!deleteResponse.ok) {
                throw new Error('Failed to delete company');
            }
            
            await Swal.fire(
                'Deleted!',
                'The company has been removed.',
                'success'
            );
            
            // Refresh data
            loadCompanyData();
        }
    } catch (error) {
        console.error('Deletion error:', error);
        Swal.fire({
            icon: 'error',
            title: 'Deletion Failed',
            text: 'Error deleting company: ' + error.message,
            confirmButtonText: 'OK'
        });
    }
}
</script>
  </body>
</html>
